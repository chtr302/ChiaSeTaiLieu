<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
<div th:fragment="sidebar(sinhVien, activePage)" class="sidebar" id="sidebar">
    <div class="sidebar-padding"></div>
    <div class="sidebar-content">
        <div class="sidebar-header">
            <div class="user-profile" id="user-profile">
                <a th:href="@{/library}" class="user-profile-link">
                    <img class="avatar" th:src="${sinhVien != null ? sinhVien.hinhAnh : ''}" 
                         th:alt="${sinhVien != null ? sinhVien.hoVaTen : 'User'}" 
                         onerror="this.src='/img/default-avatar.png'">
                    <div class="user-info">
                        <p class="username" th:text="${sinhVien != null ? sinhVien.hoVaTen : 'User'}">Username</p>
                    </div>
                </a>
            </div>
            <button id="upload-btn" class="upload-button" onclick="window.location.href='/upload'">
                <i class="fas fa-cloud-upload-alt"></i> Upload Documents
            </button>
        </div>
        <ul class="sidebar-menu">
            <li class="sidebar-item" th:classappend="${activePage == 'home' ? 'active' : ''}">
                <a th:href="@{/index}">
                    <i class="fas fa-home"></i> Home
                </a>
            </li>
            <li class="sidebar-item" th:classappend="${activePage == 'documents' ? 'active' : ''}">
                <a th:href="@{/documents}">
                    <i class="fas fa-book"></i> Documents
                </a>
            </li>
            <li class="sidebar-item" th:classappend="${activePage == 'library' ? 'active' : ''}">
                <a th:href="@{/library}">
                    <i class="fas fa-folder-open"></i> Library
                </a>
            </li>
            <li class="sidebar-item dropdown" id="recents-dropdown">
                <a href="javascript:void(0);">
                    <i class="fas fa-clock"></i> Recents
                    <i class="fas fa-chevron-down dropdown-icon"></i>
                </a>
                <div class="dropdown-content" id="recents-dropdown-content">
                    <!-- Will be populated with JavaScript -->
                </div>
            </li>
        </ul>
    </div>
</div>

<!-- Recents History JavaScript -->
<script th:src="@{/js/recents-history.js}"></script>
<script th:inline="javascript">
    // Initialize recents history for sidebar
    (function() {
        function initializeSidebarRecents() {
            console.log('Initializing sidebar recents...');
            if (typeof initRecentsHistory === 'function') {
                try {
                    initRecentsHistory();
                    console.log('Recents history initialized successfully');
                } catch (error) {
                    console.error('Error initializing recents history:', error);
                }
            } else {
                console.error('initRecentsHistory function not found');
            }
        }

        // Try to initialize immediately if DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeSidebarRecents);
        } else {
            // DOM is already ready, initialize immediately
            setTimeout(initializeSidebarRecents, 100);
        }
    })();
</script>
</body>
</html> 