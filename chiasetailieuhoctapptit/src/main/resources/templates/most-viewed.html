<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/head :: head('Most Viewed Documents')"></head>
<body class="documents-page">
  <div th:replace="fragments/navbar :: navbar(sinhVien=${sinhVien})"></div>
  <main class="main">
    <section class="documents-section">
      <div class="documents-container">
        <!-- Main Content -->
        <div class="main-content">
          <div class="content-header">
            <div class="search-area">
              <button id="menu-toggle" class="menu-toggle">
                <i class="fas fa-bars"></i>
              </button>
              <div class="search-bar">
                <input type="text" placeholder="Search for documents..." class="search-input document-search">
                <i class="fas fa-search search-icon"></i>
              </div>
            </div>
          </div>
          
          <!-- Filter Section -->
          <div class="filter-section">
            <h2 class="page-title">Most Viewed Documents</h2>
          </div>
          
          <!-- Content Container -->
          <div class="content-container">
            <div class="document-grid full-width">
              <!-- Document Card -->
              <div class="document-grid">
                <div class="document-card" th:each="doc, docStat : ${Documents}" th:if="${docStat.index < 4}">
                  
                  <!-- Thumbnail -->
                  <img th:if="${doc.thumbnail != null}" th:src="@{'/documents/thumbnails/' + ${doc.thumbnail}}" 
                       alt="Document Preview" class="document-image">
                  <img th:if="${doc.thumbnail == null}" src="/img/default-document.png" 
                       alt="Document Preview" class="document-image">
              
                  <!-- Details -->
                  <div class="document-details">
                    <p class="document-title" th:text="${doc.tieuDe}">Document Title</p>
                    <div class="document-category">
                      <p>
                        <i class="fas fa-book"></i>
                        <span th:text="${doc.tenMon}">Course</span>
                      </p>
                      <p>
                        <i class="fas fa-folder"></i>
                        <span th:text="${doc.tenLoai}">Category</span>
                      </p>
                    </div>
                    
                    
              
                    <!-- Stats Row -->
                    <div class="document-stats-row">
                      <!-- Vote Section -->
                      <div class="vote-oval">
                        <button class="upvote-btn"><i class="fas fa-thumbs-up"></i></button>
                        <span class="vote-count" th:text="${doc != null && doc.danhGia != null ? doc.danhGia : '0'}">0</span>
                        <button class="downvote-btn"><i class="fas fa-thumbs-down"></i></button>
                      </div>
              
                      <!-- Views & Comments -->
                      <div class="view-comment-group">
                        <span class="views"><i class="fas fa-eye"></i> <span th:text="${doc != null && doc.luotXem != null ? doc.luotXem : '0'}">0</span></span>
                        <span class="comments"><i class="fas fa-comment"></i> <span th:text="${doc != null && doc.soLuongBL != null ? doc.soLuongBL : '0'}">0</span></span>
                      </div>
                    </div>
              
                    <!-- Action Buttons -->
                    <div class="document-buttons">
                      <a th:href="@{'/documents/detail/' + ${doc.maTaiLieu}}" class="view-btn">Xem</a>
                      <button class="save-btn">LÆ°u</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Pagination -->
            <div class="pagination">
              <a th:if="${currentPage > 1}" 
                 th:href="@{/documents/most-viewed(page=${currentPage - 1})}" 
                 class="page-btn prev">
                <i class="fas fa-chevron-left"></i>
              </a>
              <span th:unless="${currentPage > 1}" class="page-btn prev disabled">
                <i class="fas fa-chevron-left"></i>
              </span>
              
              <div class="page-numbers" id="page-numbers">
                <!-- Page numbers will be generated by JS -->
              </div>
              
              <a th:if="${currentPage < totalPages}" 
                 th:href="@{/documents/most-viewed(page=${currentPage + 1})}" 
                 class="page-btn next">
                <i class="fas fa-chevron-right"></i>
              </a>
              <span th:unless="${currentPage < totalPages}" class="page-btn next disabled">
                <i class="fas fa-chevron-right"></i>
              </span>
            </div>
            
            <!-- No Documents Message -->
            <div th:if="${#lists.isEmpty(Documents)}" class="no-documents">
              <i class="fas fa-file-alt"></i>
              <p>No documents found</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Scripts -->
  <div th:replace="fragments/scripts :: scripts"></div>
  <link th:href="@{/css/documents.css}" rel="stylesheet">
  <script th:src="@{/js/document.js}"></script>
  <script th:src="@{/js/all-documents.js}"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Search functionality
      const searchInput = document.querySelector('.document-search');
      if (searchInput) {
        searchInput.addEventListener('input', function() {
          const searchValue = this.value.toLowerCase();
          const documentCards = document.querySelectorAll('.document-card');
          
          documentCards.forEach(card => {
            const documentTitle = card.querySelector('.document-title').textContent.toLowerCase();
            const documentCategory = card.querySelector('.document-category').textContent.toLowerCase();
            
            if (documentTitle.includes(searchValue) || documentCategory.includes(searchValue)) {
              card.style.display = 'flex';
            } else {
              card.style.display = 'none';
            }
          });
        });
      }
    });
  </script>
</body>
</html> 